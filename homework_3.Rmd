---
title: "Homework 3"
author: '2101377'
date: "04/03/2022"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Required libraries:
* tidyverse
* lme4
* readr
* factoextra

```{r include=FALSE}
library(tidyverse)
library(lme4)
stroop_d <- read.csv("stroop_standing_data.csv")
library(readr)
library(factoextra)
spotify_cleaned <- read_csv("spotify_cleaned.csv")
```

# 2 Stroop, standing up or sitting down

In order to analyze the data for the Stroop task. 

# 3 The Dimensions of Popular Music
We will start attempting to replicate the results obtained by Pratham Nawal by examining the data.

```{r}
glimpse(spotify_cleaned)
```

It's apparent that we still need to clear out some data that is not pertinent to the actual characteristics of the songs. The data that will be omitted in the PCA are the column number (it is redundant as r keeps track of that anyway), the track name, the artist and the number of streams.

spotify_for_pca <- select(spotify_cleaned, - "...1", -"Track Name", -"Artist",-"Streams")
pca_spotify <- prcomp(spotify_for_pca)
summary(pca_spotify)
factoextra::fviz_eig(pca_spotify)
# we can see that we replicated the PCA results from the initial analysis of Pratham Nawal
# PC1 explains 64% of the data, and PC2 explains 35% of the data.

fviz_pca_var(pca_spotify, repel = TRUE, alpha.var = 0.5)
cor(spotify_for_pca)


#but what happens if we scale it?
pca_spotify_scaled <- prcomp(spotify_for_pca, scale = TRUE)
summary(pca_spotify_scaled)
factoextra::fviz_eig(pca_spotify_scaled)
fviz_contrib(pca_spotify_scaled, choice="var", axes = 1)
fviz_contrib(pca_spotify_scaled, choice="var", axes = 2)

fviz_pca_var(pca_spotify_scaled, repel = TRUE, alpha.var = 0.5)
cor(spotify_for_pca)

# how to improve on their analysis?
# I would inspect which elements of the PC1 and PC2 are actually contributing to the variance
fviz_contrib(pca_spotify, choice="var", axes = 1)
fviz_contrib(pca_spotify, choice="var", axes = 2)
# it seems like in both dimensions, there is only one main component that contributes to the variance of the factor
# so what if we leave only those two in? Meaning, tempo and duration
spotify_for_pca_2 <- select(spotify_cleaned, - "...1", -"Track Name", -"Artist",-"Streams", -"danceability", -"energy", -"key", -"loudness", -"mode", -"speechiness", -"acousticness", -"instrumentalness", -"liveness", -"valence", -"time_signature")
pca_spotify_2 <- prcomp(spotify_for_pca_2)
summary(pca_spotify_2)
fviz_pca_var(pca_spotify_2, repel = TRUE, alpha.var = 0.5)
# well, it seems Alasdair was right
# but what if we scale it too
pca_spotify_2_scaled <- prcomp(spotify_for_pca_2, scale = TRUE)
summary(pca_spotify_2_scaled)
fviz_pca_var(pca_spotify_2_scaled, repel = TRUE, alpha.var = 0.5)

# we can see that the tempo and duration are still significant factors here




```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
