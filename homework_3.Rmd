---
title: "Homework 3"
author: '2101377'
date: "04/03/2022"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Required R packages:
* tidyverse
* lme4
* readr
* factoextra

# Required files:
* stroop_standing_data.csv
* spotify_cleaned.csv

```{r include=FALSE}
options(scipen = 5, digits = 3)
library(tidyverse)
library(lme4)
stroop_d <- read.csv("stroop_standing_data.csv")
library(readr)
library(factoextra)
spotify_cleaned <- read_csv("spotify_cleaned.csv")
library(ggrepel)
```

# 2 Stroop, standing up or sitting down

In order to analyze the data for the Stroop task. 

# 3 The Dimensions of Popular Music
We will start attempting to replicate the results obtained by Pratham Nawal by examining the data.

```{r glimpse into spotify}
glimpse(spotify_cleaned)
```

It's apparent that we still need to clear out some data that is not pertinent to the actual characteristics of the songs. The data that will be omitted in the PCA are the column number (it is redundant as r keeps track of that anyway), the track name, the artist and the number of streams.

``` {r include = FALSE}
spotify_for_pca <- select(spotify_cleaned, - "...1", -"Track Name", -"Artist",-"Streams")
pca_spotify <- prcomp(spotify_for_pca)
```

``` {r spotify PCA}
summary(pca_spotify)
```

```{r PCA scree plot, echo=FALSE}
factoextra::fviz_eig(pca_spotify)
```

We can see that we replicated the PCA results from the initial analysis of Pratham Nawal. PC1 explains approximately around 64% of the variance in the data, and PC2 explains 35% of the variance.

```{r PCA12 plot, warning=FALSE, echo = FALSE}

fviz_pca_var(pca_spotify, repel = TRUE, alpha.var = 0.5) 
fviz_contrib(pca_spotify, choice="var", axes = 1)
fviz_contrib(pca_spotify, choice="var", axes = 2)
```

It seems like tempo and duration are the most prominent factors of this whole analysis, each being distinct from the other song characteristics. These findings suggest that the tempo and duration of a modern pop song can easily predict if it is going to be popular. All the other factors seem to be of lesser significance, as they were found to be much less important in the analysis. However, it is worth noting that not all the variables compared here are measured in the same way. Tempo and duration are measured such, that the values of the data points are much higher compared to other factors.

So what happens if we normalize the variables? That would allow us to compare the other aspects of the songs in a more nuanced manner. 

``` {r scaled, echo = FALSE} 
pca_spotify_scaled <- prcomp(spotify_for_pca, scale = TRUE)
summary(pca_spotify_scaled)
factoextra::fviz_eig(pca_spotify_scaled)
fviz_contrib(pca_spotify_scaled, choice="var", axes = 1)
fviz_contrib(pca_spotify_scaled, choice="var", axes = 2)
fviz_pca_var(pca_spotify_scaled, repel = TRUE, alpha.var = 0.5)
```


